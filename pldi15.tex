%
% LaTeX template for prepartion of submissions to PLDI'15
%
% Requires sigplanconf style file provided on PLDI'15 web site
%
\documentclass[9pt]{sigplanconf}

%
% the following standard packages may be helpful, but are not required
%
%\usepackage{SIunits}            % typset units correctly
\usepackage{courier}            % standard fixed width font
\usepackage[scaled]{helvet} % see www.ctan.org/get/macros/latex/required/psnfss/psnfss2e.pdf
\usepackage{url}                  % format URLs
\usepackage{listings}          % format code
\usepackage{enumitem}      % adjust spacing in enums
% Links should be black and should'nt be underlined. 
\usepackage[breaklinks,draft=false]{hyperref}   % hyperlinks, including DOIs and URLs in bibliography
\usepackage[tight,hang]{subfigure}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{mathpartir}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{textcomp}
% Captions for tables need to be on the top. For figures, they need to
% be at the bottom
\usepackage[labelfont=bf, tableposition=top]{caption}
% ACM-recommended character encoding
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{microtype}
% For balance of columns on the last page.
\usepackage{flushend}

\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{amsthm}
\usepackage[ruled,vlined,linesnumbered]{algorithm2e}
%==============================================================================


\newcommand{\cf}[1]{{\small\tt #1}}
\newcommand{\rcf}[1]{\mathrm{\cf{#1}}}
\newcommand{\conj}{~\wedge~}
\definecolor{darkgreen}{rgb}{0,0.5,0}
\definecolor{darkred}{rgb}{0.5,0,0}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% General
\font\nine=cmr9

\font\ninerm=cmr9
\font\ninebf=cmbx9
\font\nineit=cmti9
\font\ninesl=cmsl9
\font\ninett=cmtt9
\font\ninemi=cmmi9  \skewchar\ninemi='177
\font\ninesy=cmsy9  \skewchar\ninesy='60
\font\nineex=cmex10

%%%%%%%%%%%%%%%%%%%%%%%
%% Math Fonts

\font\mathninerm=cmr9
\font\mathninei=cmmi9
\font\mathninesy=cmsy9


\def\ninepoint{\def\rm{\fam0\ninerm}%
\textfont0=\mathninerm\scriptfont0=\mathsevenrm\scriptscriptfont0=\mathfiverm%
\textfont1=\mathninei\scriptfont1=\mathseveni\scriptscriptfont1=\mathfivei%
\textfont2=\mathninesy\scriptfont2=\mathsevensy\scriptscriptfont2=\mathfivesy%
\textfont3=\tenex
\let\sc=\sevenrm
 \def\it{\fam\itfam\nineit}%
  \textfont\itfam=\nineit
  \def\bf{\fam\bffam\ninebf}%
  \textfont\bffam=\ninebf
  \def\tt{\fam\ttfam\ninett}%
  \textfont\ttfam=\ninett
  \setbox\strutbox=\hbox{\vrule height9pt depth4pt width0pt}%
  \baselineskip=11pt\rm}


\newenvironment{boxit}{\vbox\bgroup\hrule\hbox\bgroup\vrule\kern3pt
    \vbox\bgroup\kern3pt\advance\hsize by -6.8pt\relax}{\par\kern3pt\egroup\kern3pt\vrule\egroup\hrule\egroup}

\font\matheightrm=cmr8
\font\matheightbf=cmbx8
\font\matheighti=cmmi8
\font\matheightsy=cmsy8
\font\eightit=cmti8
\font\eighttt=cmtt8



\def\eightpoint{%
\textfont0=\matheightrm%
\scriptfont0=\mathsixrm\scriptscriptfont0=\mathfiverm
\textfont1=\matheighti\scriptfont1=\mathsixi\scriptscriptfont1=\mathfivei%
\textfont2=\matheightsy\scriptfont2=\mathsixsy\scriptscriptfont2=\mathfivesy%
\def\rm{\fam0\matheightrm}%
\def\it{\fam\itfam\eightit}%
\textfont\itfam=\eightit%
  \def\bf{\fam\bffam\matheightbf}%
  \textfont\bffam=\matheightbf%
  \def\tt{\fam\ttfam\eighttt}%
  \textfont\ttfam=\eighttt%
  \setbox\strutbox=\hbox{\vrule height7pt depth2pt width0pt}%
 \baselineskip=9pt\rm}

\newfam\smallttfam
\newfam\smallfam
\textfont\smallttfam=\ninett
\textfont\smallfam=\matheightrm

\lstloadlanguages{sql}
\newcommand{\lstsql}{\lstset{
      language=sql,
      basicstyle=\ttfamily\footnotesize\small,
      flexiblecolumns=false,
      %basewidth={0.5em,0.45em},
      %aboveskip={3pt},
      %belowskip={3pt},
      keywordstyle=\color{blue}\bfseries,
      commentstyle=\color{darkgreen}\itshape,
      % ugh, it keywords map/sort/zipwith.  should do this for
      % consistency or figure out how to disable those other keywords:
      morekeywords={string,REFERENCES}
    }}
\lstnewenvironment{codesql}
    { % \centering
			\lstsql
      \lstset{}%
      \csname lst@setfirstlabel\endcsname}
    { %\centering
      \csname lst@savefirstlabel\endcsname}

\lstloadlanguages{python}
\newcommand{\lstpython}{\lstset{
      language=python,
      basicstyle=\ttfamily\footnotesize,
      flexiblecolumns=false,
      %basewidth={0.5em,0.45em},
      %aboveskip={3pt},
      %belowskip={3pt},
      keywordstyle=\color{blue}\bfseries,
      commentstyle=\color{darkgreen}\itshape,
      % ugh, it keywords map/sort/zipwith.  should do this for
      % consistency or figure out how to disable those other keywords:
      morekeywords={atomically},
    }}
\lstnewenvironment{codepython}
    { % \centering
			\lstpython
      \lstset{}%
      \csname lst@setfirstlabel\endcsname}
    { %\centering
      \csname lst@savefirstlabel\endcsname}


\lstloadlanguages{haskell}
\newcommand{\lsthaskell}{\lstset{
      language=haskell,
      basicstyle=\ttfamily\ninett\footnotesize,
      flexiblecolumns=false,
			tabsize=2,
      %basewidth={0.5em,0.45em},
      %aboveskip={3pt},
      %belowskip={3pt},
      keywordstyle=\color{blue}\bfseries,
      commentstyle=\color{darkgreen}\itshape,
      % ugh, it keywords map/sort/zipwith.  should do this for
      % consistency or figure out how to disable those other keywords:
      morekeywords={foldl,fold,Quelea},
			classoffset=1,
			upquote=true,
			morekeywords={sameObj,vis,so,SameObj,So,true,Vis},
			keywordstyle=\color{Fuchsia}\bfseries,
			classoffset=0,
			mathescape=true,
      literate={+}{{$+$}}1 {/}{{$/$}}1 {*}{{$*$}}1 % {=}{{$=$}}1
               {>}{{$>$}}1 {<}{{$<$}}1
							 {dollar}{{\$}}1
               {\\\\}{{\char`\\\char`\\}}1
               {->}{{$\rightarrow$}}2 {>=}{{$\geq$}}2 {<-}{{$\leftarrow$}}2
               {<=}{{$\leq$}}2 {=>}{{$\Rightarrow$}}2
               {\ .}{{$\circ$}}2 {\ .\ }{{$\circ$}}2
               {>>}{{>>}}2 {>>=}{{>>=}}2 {=<<}{{=<<}}2
               {|}{{$\mid$}}1
							 {(-}{{$\in$}}1
						   {psi1}{{$\psi_1$}}1 {psi2}{{$\psi_2$}}1
							 {cup}{{$\cup$}}1
							 {cap}{{$\cap$}}1
							 {forall}{{$\forall$}}1
							 {vee}{{$\vee$}}1
							 {wedge}{{$\wedge$}}1
               {`member`}{{$\in$}}1
               {s.empty}{{\{\}}}1
               {leftbrace}{\{}1
               {rightbrace}{\}}1
               {profile0sing}{{ \{{\tt profile0}\}}}1
               {\$singleton\$startv}{{ \hspace{2.4em} \{{\tt startv}\}}}1
               {\$singleton\$n}{{  \{{\tt n}\}}}1
               {dotdotdot}{{$\ldots$}}3
    }}
\lstnewenvironment{codehaskell}
    { % \centering
			\lsthaskell
      \lstset{}%
      \csname lst@setfirstlabel\endcsname}
    { %\centering
      \csname lst@savefirstlabel\endcsname}
% known bug: http://tex.stackexchange.com/questions/1522/pdfendlink-ended-up-in-different-nesting-level-than-pdfstartlink
\newcommand{\doi}[1]{doi:~\href{http://dx.doi.org/#1}{\Hurl{#1}}}   % print a hyperlinked DOI

\include{mydefs}

\newcommand{\ecds}{ECDS\xspace}

% To eliminate orphans
\clubpenalty = 10000
\widowpenalty = 10000
\displaywidowpenalty = 10000

\begin{document}
\conferenceinfo{PLDI'15}{, June 13--17, 2015, Portland, OR, USA}
\CopyrightYear{2015}
\crdata{978-1-4503-3468-6/15/06}
%
% any author declaration will be ignored  when using 'pldi' option (for double blind review)
%
\title{Declarative Programming over Eventually Consistent Data Stores }

\authorinfo{KC Sivaramakrishnan}{University of Cambridge, UK}{sk826@cl.cam.ac.uk}
\authorinfo{Gowtham Kaki}{Purdue University, USA}{gkaki@cs.purdue.edu}
\authorinfo{Suresh Jagannathan}{Purdue University, USA}{suresh@cs.purdue.edu}

\maketitle
\begin{abstract}
User-facing online services utilize geo-distributed data stores to minimize
latency and tolerate partial failures, with the intention to provide a fast,
always-on experience. However, geo-distribution does not come for free;
application developers have to contend with weak consistency behaviors, and
the lack of abstractions to composably construct high-level replicated data
types, necessitating the need for complex application logic and invariably
exposing inconsistencies to the user. Some commercial distributed data
stores and several academic proposals provide a lattice of consistency
levels, with stronger consistency guarantees incurring increased latency and
throughput costs. However, correctly assigning the right consistency level
for an operation requires subtle reasoning and is often an error-prone task.

In this paper, we present \name, a declarative programming model for eventually
consistent data stores (\ecds), equipped with a \emph{contract} language,
capable of specifying fine-grained application-level consistency properties. A
\emph{contract enforcement system} analyses contracts, and \emph{automatically}
generates the appropriate consistency protocol for the method protected by the
contract. We describe an implementation of \name\ on top of an off-the-shelf
\ecds, and provide support for \emph{coordination-free} transactions. Several
benchmarks including two large web applications, illustrate the effectiveness
of our approach.
\end{abstract}

% Classification
\category{D.1.3}{Concurrent Programming}{Distributed Programming}
\category{C.2.4}{Distributed Systems}{Distributed databases}
\category{D.3.2}{Language Classifications}{Applicative (Functional) Languages}
\category{F.3.1}{Logics and Meanings of Programs}{Specifying and Verifying and Reasoning about Programs}

\terms
Languages, Performance 

\keywords
Eventual Consistency, Availability, CRDTs, Axiomatic Contracts,
Contract Classification, Distributed Transactions, SMT solvers,
Decidable Logic, Quelea, Cassandra, Haskell 

\input{intro}

\input{model}

\input{motivation}

\input{contract-language}

\input{transactions}

\input{implementation}

\input{evaluation}

\input{related}

\input{concl}

\bibliographystyle{abbrvnat}
\small
\bibliography{all}

\end{document}
